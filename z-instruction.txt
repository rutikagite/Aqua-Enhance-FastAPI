& P:\AquaEnhance-main\AquaEnhance-main\venv\Scripts\Activate.ps1


(venv) PS P:\AquaEnhance-main\AquaEnhance-main> python run.py
P:\AquaEnhance-main\AquaEnhance-main\run.py:874: FutureWarning: `torch.cuda.amp.GradScaler(args...)` is deprecated. Please use `torch.amp.GradScaler('cuda', args...)` instead.
  scaler = GradScaler()
MACS: 137.55 GMac
Params: 2.09 M

Start Stage 1
==========>Start Training<==========
Since from 1th Epoch
  0%|                                                                                           | 0/312 [00:00<?, ?it/s]P:\AquaEnhance-main\AquaEnhance-main\engine\dehaze.py:42: FutureWarning: `torch.cuda.amp.autocast(args...)` is deprecated. Please use `torch.amp.autocast('cuda', args...)` instead.
  with autocast(hparams['train']['use_amp']):
100%|█████████████████████████████████████████████████████████████████████████████████| 312/312 [03:42<00:00,  1.40it/s]

Epoch:  1
train_loss :   0.4538
lr :   1e-06
valid_loss :   0.3748
ssim :   0.2326
psnr :   8.5794
best ssim:  0.2326   best epoch:  1
best psnr:  8.5794   best epoch:  1
100%|█████████████████████████████████████████████████████████████████████████████████| 312/312 [03:42<00:00,  1.40it/s]

Epoch:  2
train_loss :   0.1322
lr :   8.45e-06
valid_loss :   0.0907
ssim :   0.849
psnr :   20.3502
best ssim:  0.849   best epoch:  2
best psnr:  20.3502   best epoch:  2
100%|█████████████████████████████████████████████████████████████████████████████████| 312/312 [03:44<00:00,  1.39it/s]

Epoch:  3
train_loss :   0.094
lr :   1.59e-05
valid_loss :   0.0841
ssim :   0.8743
psnr :   20.9928
best ssim:  0.8743   best epoch:  3
best psnr:  20.9928   best epoch:  3
100%|█████████████████████████████████████████████████████████████████████████████████| 312/312 [03:40<00:00,  1.41it/s]

Epoch:  4
train_loss :   0.0898
lr :   2.3350000000000002e-05
valid_loss :   0.0864
ssim :   0.8605
psnr :   20.7347
best ssim:  0.8743   best epoch:  3
best psnr:  20.9928   best epoch:  3
100%|█████████████████████████████████████████████████████████████████████████████████| 312/312 [03:42<00:00,  1.40it/s]

Epoch:  5
train_loss :   0.0874
lr :   3.0799999999999996e-05
valid_loss :   0.0819
ssim :   0.8808
psnr :   21.0884
best ssim:  0.8808   best epoch:  5
best psnr:  21.0884   best epoch:  5
100%|█████████████████████████████████████████████████████████████████████████████████| 312/312 [03:41<00:00,  1.41it/s]

Epoch:  6
train_loss :   0.0844
lr :   3.8249999999999995e-05
valid_loss :   0.0756
ssim :   0.8873
psnr :   21.8192
best ssim:  0.8873   best epoch:  6
best psnr:  21.8192   best epoch:  6
100%|█████████████████████████████████████████████████████████████████████████████████| 312/312 [03:41<00:00,  1.41it/s]

Epoch:  7
train_loss :   0.0824
lr :   4.57e-05
valid_loss :   0.075
ssim :   0.8929
psnr :   21.7587
best ssim:  0.8929   best epoch:  7
best psnr:  21.8192   best epoch:  6
100%|█████████████████████████████████████████████████████████████████████████████████| 312/312 [03:41<00:00,  1.41it/s]

Epoch:  8
train_loss :   0.0812
lr :   5.315e-05
valid_loss :   0.0859
ssim :   0.8864
psnr :   20.6442
best ssim:  0.8929   best epoch:  7
best psnr:  21.8192   best epoch:  6
100%|█████████████████████████████████████████████████████████████████████████████████| 312/312 [03:40<00:00,  1.41it/s]

Epoch:  9
train_loss :   0.077
lr :   6.0599999999999996e-05
valid_loss :   0.0755
ssim :   0.8913
psnr :   21.9364
best ssim:  0.8929   best epoch:  7
best psnr:  21.9364   best epoch:  9
100%|█████████████████████████████████████████████████████████████████████████████████| 312/312 [03:43<00:00,  1.40it/s]

Epoch:  10
train_loss :   0.0767
lr :   6.805e-05
valid_loss :   0.0698
ssim :   0.9018
psnr :   22.468
best ssim:  0.9018   best epoch:  10
best psnr:  22.468   best epoch:  10
100%|█████████████████████████████████████████████████████████████████████████████████| 312/312 [03:42<00:00,  1.40it/s]

Epoch:  11
train_loss :   0.0766
lr :   7.549999999999999e-05
valid_loss :   0.0749
ssim :   0.877
psnr :   21.9057
best ssim:  0.9018   best epoch:  10
best psnr:  22.468   best epoch:  10
100%|█████████████████████████████████████████████████████████████████████████████████| 312/312 [03:41<00:00,  1.41it/s]

Epoch:  12
train_loss :   0.0744
lr :   8.295e-05
valid_loss :   0.0688
ssim :   0.9039
psnr :   22.6748
best ssim:  0.9039   best epoch:  12
best psnr:  22.6748   best epoch:  12
100%|█████████████████████████████████████████████████████████████████████████████████| 312/312 [03:41<00:00,  1.41it/s]

Epoch:  13
train_loss :   0.0733
lr :   9.04e-05
valid_loss :   0.0671
ssim :   0.9059
psnr :   22.8319
best ssim:  0.9059   best epoch:  13
best psnr:  22.8319   best epoch:  13
100%|█████████████████████████████████████████████████████████████████████████████████| 312/312 [03:41<00:00,  1.41it/s]

Epoch:  14
train_loss :   0.0724
lr :   9.784999999999999e-05
valid_loss :   0.0699
ssim :   0.9006
psnr :   22.4332
best ssim:  0.9059   best epoch:  13
best psnr:  22.8319   best epoch:  13
100%|█████████████████████████████████████████████████████████████████████████████████| 312/312 [03:48<00:00,  1.36it/s]

Epoch:  15
train_loss :   0.0732
lr :   0.0001053
valid_loss :   0.0709
ssim :   0.9011
psnr :   22.2617
best ssim:  0.9059   best epoch:  13
best psnr:  22.8319   best epoch:  13
100%|█████████████████████████████████████████████████████████████████████████████████| 312/312 [03:48<00:00,  1.37it/s]

Epoch:  16
train_loss :   0.0724
lr :   0.00011274999999999999
valid_loss :   0.0767
ssim :   0.89
psnr :   21.7783
best ssim:  0.9059   best epoch:  13
best psnr:  22.8319   best epoch:  13
100%|█████████████████████████████████████████████████████████████████████████████████| 312/312 [03:47<00:00,  1.37it/s]

Epoch:  17
train_loss :   0.0725
lr :   0.0001202
valid_loss :   0.0678
ssim :   0.9037
psnr :   22.8511
best ssim:  0.9059   best epoch:  13
best psnr:  22.8511   best epoch:  17
100%|█████████████████████████████████████████████████████████████████████████████████| 312/312 [03:47<00:00,  1.37it/s]

Epoch:  18
train_loss :   0.0705
lr :   0.00012764999999999999
valid_loss :   0.0674
ssim :   0.9043
psnr :   22.8533
best ssim:  0.9059   best epoch:  13
best psnr:  22.8533   best epoch:  18
100%|█████████████████████████████████████████████████████████████████████████████████| 312/312 [03:45<00:00,  1.39it/s]

Epoch:  19
train_loss :   0.0711
lr :   0.0001351
valid_loss :   0.0721
ssim :   0.8982
psnr :   22.2539
best ssim:  0.9059   best epoch:  13
best psnr:  22.8533   best epoch:  18
100%|█████████████████████████████████████████████████████████████████████████████████| 312/312 [03:41<00:00,  1.41it/s]

Epoch:  20
train_loss :   0.0725
lr :   0.00014255
valid_loss :   0.0739
ssim :   0.9031
psnr :   21.8264
best ssim:  0.9059   best epoch:  13
best psnr:  22.8533   best epoch:  18
100%|█████████████████████████████████████████████████████████████████████████████████| 312/312 [03:41<00:00,  1.41it/s]

Epoch:  21
train_loss :   0.0681
lr :   9.852176608093358e-05
valid_loss :   0.0664
ssim :   0.9089
psnr :   22.9491
best ssim:  0.9089   best epoch:  21
best psnr:  22.9491   best epoch:  21
100%|█████████████████████████████████████████████████████████████████████████████████| 312/312 [03:43<00:00,  1.40it/s]

Epoch:  22
train_loss :   0.0665
lr :   9.402739659378166e-05
valid_loss :   0.0677
ssim :   0.9101
psnr :   22.9289
best ssim:  0.9101   best epoch:  22
best psnr:  22.9491   best epoch:  21
100%|█████████████████████████████████████████████████████████████████████████████████| 312/312 [03:40<00:00,  1.41it/s]

Epoch:  23
train_loss :   0.066
lr :   8.945990793663649e-05
valid_loss :   0.0671
ssim :   0.9082
psnr :   22.768
best ssim:  0.9101   best epoch:  22
best psnr:  22.9491   best epoch:  21
100%|█████████████████████████████████████████████████████████████████████████████████| 312/312 [03:41<00:00,  1.41it/s]

Epoch:  24
train_loss :   0.0648
lr :   8.483732590054067e-05
valid_loss :   0.0671
ssim :   0.9085
psnr :   22.8999
best ssim:  0.9101   best epoch:  22
best psnr:  22.9491   best epoch:  21
100%|█████████████████████████████████████████████████████████████████████████████████| 312/312 [03:41<00:00,  1.41it/s]

Epoch:  25
train_loss :   0.0651
lr :   8.017789370493384e-05
valid_loss :   0.0659
ssim :   0.9148
psnr :   23.205
best ssim:  0.9148   best epoch:  25
best psnr:  23.205   best epoch:  25
100%|█████████████████████████████████████████████████████████████████████████████████| 312/312 [03:41<00:00,  1.41it/s]

Epoch:  26
train_loss :   0.0638
lr :   7.549999999999999e-05
valid_loss :   0.0706
ssim :   0.909
psnr :   22.5857
best ssim:  0.9148   best epoch:  25
best psnr:  23.205   best epoch:  25
100%|█████████████████████████████████████████████████████████████████████████████████| 312/312 [03:42<00:00,  1.40it/s]

Epoch:  27
train_loss :   0.0631
lr :   7.082210629506615e-05
valid_loss :   0.067
ssim :   0.9055
psnr :   22.9104
best ssim:  0.9148   best epoch:  25
best psnr:  23.205   best epoch:  25
100%|█████████████████████████████████████████████████████████████████████████████████| 312/312 [03:46<00:00,  1.38it/s]

Epoch:  28
train_loss :   0.0633
lr :   6.616267409945934e-05
valid_loss :   0.0645
ssim :   0.9052
psnr :   23.0989
best ssim:  0.9148   best epoch:  25
best psnr:  23.205   best epoch:  25
100%|█████████████████████████████████████████████████████████████████████████████████| 312/312 [03:41<00:00,  1.41it/s]

Epoch:  29
train_loss :   0.0619
lr :   6.154009206336351e-05
valid_loss :   0.064
ssim :   0.9111
psnr :   23.3155
best ssim:  0.9148   best epoch:  25
best psnr:  23.3155   best epoch:  29
100%|█████████████████████████████████████████████████████████████████████████████████| 312/312 [03:40<00:00,  1.41it/s]

Epoch:  30
train_loss :   0.0603
lr :   5.6972603406218305e-05
valid_loss :   0.0589
ssim :   0.9218
psnr :   23.9418
best ssim:  0.9218   best epoch:  30
best psnr:  23.9418   best epoch:  30
EndStage 1


Start Stage 2
==========>Start Resume<==========
Since from 31th Epoch
100%|█████████████████████████████████████████████████████████████████████████████████| 623/623 [03:53<00:00,  2.67it/s]

Epoch:  31
train_loss :   0.0638
lr :   5.247823391906643e-05
valid_loss :   0.0674
ssim :   0.9011
psnr :   22.7254
best ssim:  0.9218   best epoch:  30
best psnr:  23.9418   best epoch:  30
100%|█████████████████████████████████████████████████████████████████████████████████| 623/623 [03:53<00:00,  2.67it/s]

Epoch:  32
train_loss :   0.0623
lr :   4.807472082499151e-05
valid_loss :   0.0617
ssim :   0.9121
psnr :   23.5855
best ssim:  0.9218   best epoch:  30
best psnr:  23.9418   best epoch:  30
100%|█████████████████████████████████████████████████████████████████████████████████| 623/623 [03:53<00:00,  2.67it/s]

Epoch:  33
train_loss :   0.0608
lr :   4.377944277840208e-05
valid_loss :   0.0595
ssim :   0.92
psnr :   24.0481
best ssim:  0.9218   best epoch:  30
best psnr:  24.0481   best epoch:  33
100%|█████████████████████████████████████████████████████████████████████████████████| 623/623 [04:01<00:00,  2.58it/s]

Epoch:  34
train_loss :   0.0596
lr :   3.9609351279422197e-05
valid_loss :   0.0581
ssim :   0.9232
psnr :   24.2362
best ssim:  0.9232   best epoch:  34
best psnr:  24.2362   best epoch:  34
100%|█████████████████████████████████████████████████████████████████████████████████| 623/623 [04:03<00:00,  2.56it/s]

Epoch:  35
train_loss :   0.0583
lr :   3.558090377406473e-05
valid_loss :   0.0587
ssim :   0.9221
psnr :   24.1852
best ssim:  0.9232   best epoch:  34
best psnr:  24.2362   best epoch:  34
100%|█████████████████████████████████████████████████████████████████████████████████| 623/623 [04:03<00:00,  2.56it/s]

Epoch:  36
train_loss :   0.057
lr :   3.170999870421075e-05
valid_loss :   0.0601
ssim :   0.9201
psnr :   24.1091
best ssim:  0.9232   best epoch:  34
best psnr:  24.2362   best epoch:  34
100%|█████████████████████████████████████████████████████████████████████████████████| 623/623 [04:00<00:00,  2.59it/s]

Epoch:  37
train_loss :   0.0568
lr :   2.8011912763722613e-05
valid_loss :   0.0585
ssim :   0.9218
psnr :   24.2291
best ssim:  0.9232   best epoch:  34
best psnr:  24.2362   best epoch:  34
100%|█████████████████████████████████████████████████████████████████████████████████| 623/623 [03:57<00:00,  2.63it/s]

Epoch:  38
train_loss :   0.0556
lr :   2.4501240608312687e-05
valid_loss :   0.0583
ssim :   0.9222
psnr :   24.3102
best ssim:  0.9232   best epoch:  34
best psnr:  24.3102   best epoch:  38
100%|█████████████████████████████████████████████████████████████████████████████████| 623/623 [04:00<00:00,  2.59it/s]

Epoch:  39
train_loss :   0.0544
lr :   2.1191837257104854e-05
valid_loss :   0.0568
ssim :   0.9248
psnr :   24.4432
best ssim:  0.9248   best epoch:  39
best psnr:  24.4432   best epoch:  39
100%|█████████████████████████████████████████████████████████████████████████████████| 623/623 [03:59<00:00,  2.60it/s]

Epoch:  40
train_loss :   0.0534
lr :   1.809676341320371e-05
valid_loss :   0.0562
ssim :   0.9254
psnr :   24.545
best ssim:  0.9254   best epoch:  40
best psnr:  24.545   best epoch:  40
EndStage 2


Start Stage 3
==========>Start Resume<==========
Since from 41th Epoch
100%|█████████████████████████████████████████████████████████████████████████████████| 312/312 [03:44<00:00,  1.39it/s]

Epoch:  41
train_loss :   0.0512
lr :   1.5228233919066423e-05
valid_loss :   0.0566
ssim :   0.9248
psnr :   24.4845
best ssim:  0.9254   best epoch:  40
best psnr:  24.545   best epoch:  40
100%|█████████████████████████████████████████████████████████████████████████████████| 312/312 [03:42<00:00,  1.40it/s]

Epoch:  42
train_loss :   0.0509
lr :   1.2597569550099892e-05
valid_loss :   0.0562
ssim :   0.9252
psnr :   24.5726
best ssim:  0.9254   best epoch:  40
best psnr:  24.5726   best epoch:  42
100%|███████████████████████████████████████████████████████████████████████████████| 312/312 [5:33:42<00:00, 64.17s/it]

Epoch:  43
train_loss :   0.0502
lr :   1.0215152336732163e-05
valid_loss :   0.0557
ssim :   0.9248
psnr :   24.7511
best ssim:  0.9254   best epoch:  40
best psnr:  24.7511   best epoch:  43
100%|█████████████████████████████████████████████████████████████████████████████████| 312/312 [03:44<00:00,  1.39it/s]

Epoch:  44
train_loss :   0.05
lr :   8.090384591281558e-06
valid_loss :   0.0555
ssim :   0.9264
psnr :   24.6759
best ssim:  0.9264   best epoch:  44
best psnr:  24.7511   best epoch:  43
100%|█████████████████████████████████████████████████████████████████████████████████| 312/312 [03:44<00:00,  1.39it/s]

Epoch:  45
train_loss :   0.0495
lr :   6.231651801325274e-06
valid_loss :   0.0557
ssim :   0.9264
psnr :   24.6712
best ssim:  0.9264   best epoch:  44
best psnr:  24.7511   best epoch:  43
100%|█████████████████████████████████████████████████████████████████████████████████| 312/312 [03:40<00:00,  1.41it/s]

Epoch:  46
train_loss :   0.0491
lr :   4.6462895360110614e-06
valid_loss :   0.0553
ssim :   0.9265
psnr :   24.8136
best ssim:  0.9265   best epoch:  46
best psnr:  24.8136   best epoch:  46
100%|█████████████████████████████████████████████████████████████████████████████████| 312/312 [03:40<00:00,  1.41it/s]

Epoch:  47
train_loss :   0.0489
lr :   3.3405544959169932e-06
valid_loss :   0.0555
ssim :   0.9265
psnr :   24.6947
best ssim:  0.9265   best epoch:  46
best psnr:  24.8136   best epoch:  46
100%|█████████████████████████████████████████████████████████████████████████████████| 312/312 [03:40<00:00,  1.41it/s]

Epoch:  48
train_loss :   0.0486
lr :   2.31959982071269e-06
valid_loss :   0.0553
ssim :   0.9267
psnr :   24.7222
best ssim:  0.9267   best epoch:  48
best psnr:  24.8136   best epoch:  46
100%|█████████████████████████████████████████████████████████████████████████████████| 312/312 [03:41<00:00,  1.41it/s]

Epoch:  49
train_loss :   0.0486
lr :   1.5874547520714064e-06
valid_loss :   0.0554
ssim :   0.9266
psnr :   24.7184
best ssim:  0.9267   best epoch:  48
best psnr:  24.8136   best epoch:  46
100%|█████████████████████████████████████████████████████████████████████████████████| 312/312 [03:41<00:00,  1.41it/s]

Epoch:  50
train_loss :   0.0484
lr :   1.1470087320937688e-06
valid_loss :   0.0553
ssim :   0.9267
psnr :   24.7492
best ssim:  0.9267   best epoch:  48
best psnr:  24.8136   best epoch:  46
EndStage 3

(venv) PS P:\AquaEnhance-main\AquaEnhance-main> 